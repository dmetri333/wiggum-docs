<!DOCTYPE html>
<html lang="en-US">
	<head>
		
		<title>Controllers | Wiggum</title>
	
		<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel='stylesheet' id='prism-css'  href='/static/css/prism.css' media='all' />
<link rel='stylesheet' id='styles-css'  href='/static/css/style.css' media='all' />
	</head>

	<body>

		<header class="site-header">
	<div class="container">
		<a href="/" class="site-title">Wiggum</a>
		<div class="lead">a php framework</div>
	</div>
</header>
		
		<div class="container">
			<div class="row">
				<div class="col-md-3">
				
					<div class="docs-nav hidden-sm hidden-xs">
	<div class="docs-nav-list">
		<h4 class="title">Get Started</h4>
		<ul>
			<li class="">
				<a href="/docs/">Installation</a>
			</li>
			<li class="">
				<a href="/docs/started/configuration.php">Configuration</a>
			</li>
			<li class="">
				<a href="/docs/started/directory.php">Directory Structure</a>
			</li>
		</ul>
	</div>
	<div class="docs-nav-list">
		<h4 class="title">Foundation</h4>
		<ul>
			<li class="">
				<a href="/docs/foundation/application.php">Application</a>
			</li>
			<li class="">
				<a href="/docs/foundation/services.php">Services</a>
			</li>
			<li class="">
				<a href="/docs/foundation/middleware.php">Middleware</a>
			</li>
			<li class="">
				<a href="/docs/foundation/routing.php">Routing</a>
			</li>
		</ul>
	</div>
	<div class="docs-nav-list">
		<h4 class="title">Basics</h4>
		<ul>
			<li class="">
				<a href="/docs/basics/controller.php">Controller</a>
			</li>
			<li class="">
				<a href="/docs/basics/request.php">Request</a>
			</li>
			<li class="">
				<a href="/docs/basics/response.php">Response</a>
			</li>
		</ul>
	</div>
			
	<div class="docs-nav-list">
		<h4 class="title">Services</h4>
		<ul>
			<li class="">
				<a href="/docs/services/errorhandling/">Error Handling</a>
			</li>
			<li class="">
				<a href="/docs/services/exceptionhandling/">Exception Handling</a>
			</li>
			<li class="">
				<a href="/docs/services/logging/">Logging</a>
			</li>
			<li class="docs-nav-sub">
				<a href="/docs/services/database/">Database</a>
				<ul>
					<li>
						<a href="/docs/services/database/retrievingresults.php">Retrieving Results</a>
					</li>
					<li>
						<a href="/docs/services/database/selects.php">Selects</a>
					</li>
					<li>
						<a href="/docs/services/database/joins.php">Joins</a>
					</li>
					<li>
						<a href="/docs/services/database/unions.php">Unions</a>
					</li>
					<li>
						<a href="/docs/services/database/wheres.php">Where Clauses</a>
					</li>
					<!-- 
					<li>
						<a href="/docs/services/database/">Ordering, Grouping, Limit, & Offset</a>
					</li>
					<li>
						<a href="/docs/services/database/">Conditional Clauses</a>
					</li>
					 -->
					<li>
						<a href="/docs/services/database/inserts.php">Inserts</a>
					</li>
					<li>
						<a href="/docs/services/database/updates.php">Updates</a>
					</li>
					<li>
						<a href="/docs/services/database/delete.php">Deletes</a>
					</li>
				</ul>
			</li>
			<li class="">
				<a href="/docs/services/flashmessage/">Flash Messages</a>
			</li>
			<li class="">
				<a href="/docs/services/memcache/">Memcache</a>
			</li>
			<li class="">
				<a href="/docs/services/templates/">Templates</a>
			</li>
		</ul>
	</div>

<!-- 
			<li>
				<span class="title">Utilities</span>
				<ul>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/encryption/">Encryption</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/errors-logging/">Errors & Logging</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/file-io/">File I/O</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/hashing/">Hashing</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/templates/">Templates</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/helpers/">Helpers</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/session/">Session</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/flash-message/">Flash Message</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/utilities/image-processing/">Image Processing</a>
					</li>
				</ul>
			</li>
			<li>
				<span class="title">Database</span>
				<ul>
					<li>
						<a href="http://wiggumdocs.home.org/docs/database/basic-usage/">Basic Usage</a>
					</li>
					<li>
						<a href="http://wiggumdocs.home.org/docs/database/query-builder/">Query Builder</a>
					</li>
				</ul>
			</li>
			 -->
</div>

				</div>
				<div class="col-md-7">
				
					
					<div class="page-header">
						<h1>Middleware</h1>
					</div>
						
					<section>	
						<p>You can run code before and after your Wiggum application to manipulate the Request and Response objects as you see fit. This is called middleware. Why would you want to do this? Perhaps you want to protect your app from cross-site request forgery. Maybe you want to authenticate requests before your app runs. Middleware is perfect for these scenarios.</p>
					</section>
					
					<section>		
					
						<h2>What is middleware?</h2>
						<p>Technically speaking, a middleware is a callable that accepts three arguments:</p>
						<ul>
							<li>\wiggum\http\Request</li>
							<li>\wiggum\http\Response</li>
							<li>callable - The next middleware callable</li>
						</ul>

						<p>It can do whatever is appropriate with these objects. The only hard requirement is that a middleware MUST return an instance of \wiggum\http\Response. Each middleware SHOULD invoke the next middleware and pass it Request and Response objects as arguments.</p>
					</section>
					
					<section>	
						<h2>How do I write middleware?</h2>
						<p>Middleware is a callable that accepts three arguments: a Request object, a Response object, and the next middleware. Each middleware MUST return an instance of \Psr\Http\Message\ResponseInterface.</p>
								
						<pre><code class="language-php">&lt;?php
/**
 * Example middleware closure
 *
 * @param  \wiggum\http\Request $request 
 * @param  \wiggum\http\Response $response
 * @param  callable $next     Next middleware
 *
 * @return \wiggum\http\Response
 */
function ($request, $response, $next) {
    $response->getBody()->write('BEFORE');
    $response = $next($request, $response);
    $response->getBody()->write('AFTER');

    return $response;
};
?&gt;</code></pre>

					</section>
					<section>
						<h2>How do I add middleware?</h2>
						
						<p>All of the middleares for the Wiggum framework are stored in the middleware file usally stored in <code>app/boot/middleware.php</code>.</p>
					
						<p>Middleware is invoked for every incoming HTTP request. Add application middleware with the Wiggum application instanceâ€™s <code>addMiddleware()</code> method:</p>
					
					<pre><code class="language-php">&lt;?php
$app->addMiddleware(function ($request, $response, $next) {
	$response->getBody()->write('BEFORE');
	$response = $next($request, $response);
	$response->getBody()->write('AFTER');

	return $response;
});
?&gt;</code></pre>
					
					</section>
				
				</div>
			</div>
		</div>
		
		<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js?ver=1.10.1'></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script type="text/javascript" src="/static/js/prism.js"></script>
	</body>
</html>	
